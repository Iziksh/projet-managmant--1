<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>Class: Sprockets::Context</title>

  <link rel="stylesheet" href="../rdoc.css" type="text/css" media="screen" />

  <script src="../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="../lib/sprockets/context_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/sprockets/context.rb">lib/sprockets/context.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link">Object</p>
        
      </div>
      

      

      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-new">::new</a></li>
          
          <li><a href="#method-i-asset_data_uri">#asset_data_uri</a></li>
          
          <li><a href="#method-i-asset_path">#asset_path</a></li>
          
          <li><a href="#method-i-asset_requirable-3F">#asset_requirable?</a></li>
          
          <li><a href="#method-i-audio_path">#audio_path</a></li>
          
          <li><a href="#method-i-content_type">#content_type</a></li>
          
          <li><a href="#method-i-depend_on">#depend_on</a></li>
          
          <li><a href="#method-i-depend_on_asset">#depend_on_asset</a></li>
          
          <li><a href="#method-i-evaluate">#evaluate</a></li>
          
          <li><a href="#method-i-font_path">#font_path</a></li>
          
          <li><a href="#method-i-image_path">#image_path</a></li>
          
          <li><a href="#method-i-javascript_path">#javascript_path</a></li>
          
          <li><a href="#method-i-logical_path">#logical_path</a></li>
          
          <li><a href="#method-i-require_asset">#require_asset</a></li>
          
          <li><a href="#method-i-resolve">#resolve</a></li>
          
          <li><a href="#method-i-root_path">#root_path</a></li>
          
          <li><a href="#method-i-stub_asset">#stub_asset</a></li>
          
          <li><a href="#method-i-stylesheet_path">#stylesheet_path</a></li>
          
          <li><a href="#method-i-video_path">#video_path</a></li>
          
        </ul>
      </div>
      

      
    </div>

    <div id="project-metadata">
      
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../Sprockets.html">Sprockets</a></li>
        
          <li><a href="../Sprockets/ArgumentError.html">Sprockets::ArgumentError</a></li>
        
          <li><a href="../Sprockets/Asset.html">Sprockets::Asset</a></li>
        
          <li><a href="../Sprockets/AssetAttributes.html">Sprockets::AssetAttributes</a></li>
        
          <li><a href="../Sprockets/Base.html">Sprockets::Base</a></li>
        
          <li><a href="../Sprockets/BundledAsset.html">Sprockets::BundledAsset</a></li>
        
          <li><a href="../Sprockets/Cache.html">Sprockets::Cache</a></li>
        
          <li><a href="../Sprockets/Cache/FileStore.html">Sprockets::Cache::FileStore</a></li>
        
          <li><a href="../Sprockets/Caching.html">Sprockets::Caching</a></li>
        
          <li><a href="../Sprockets/CharsetNormalizer.html">Sprockets::CharsetNormalizer</a></li>
        
          <li><a href="../Sprockets/CircularDependencyError.html">Sprockets::CircularDependencyError</a></li>
        
          <li><a href="../Sprockets/ClosureCompressor.html">Sprockets::ClosureCompressor</a></li>
        
          <li><a href="../Sprockets/Compressing.html">Sprockets::Compressing</a></li>
        
          <li><a href="../Sprockets/ContentTypeMismatch.html">Sprockets::ContentTypeMismatch</a></li>
        
          <li><a href="../Sprockets/Context.html">Sprockets::Context</a></li>
        
          <li><a href="../Sprockets/DirectiveProcessor.html">Sprockets::DirectiveProcessor</a></li>
        
          <li><a href="../Sprockets/EcoTemplate.html">Sprockets::EcoTemplate</a></li>
        
          <li><a href="../Sprockets/EjsTemplate.html">Sprockets::EjsTemplate</a></li>
        
          <li><a href="../Sprockets/EncodingError.html">Sprockets::EncodingError</a></li>
        
          <li><a href="../Sprockets/EngineError.html">Sprockets::EngineError</a></li>
        
          <li><a href="../Sprockets/Engines.html">Sprockets::Engines</a></li>
        
          <li><a href="../Sprockets/Environment.html">Sprockets::Environment</a></li>
        
          <li><a href="../Sprockets/Error.html">Sprockets::Error</a></li>
        
          <li><a href="../Sprockets/FileNotFound.html">Sprockets::FileNotFound</a></li>
        
          <li><a href="../Sprockets/FileOutsidePaths.html">Sprockets::FileOutsidePaths</a></li>
        
          <li><a href="../Sprockets/Index.html">Sprockets::Index</a></li>
        
          <li><a href="../Sprockets/JstProcessor.html">Sprockets::JstProcessor</a></li>
        
          <li><a href="../Sprockets/Manifest.html">Sprockets::Manifest</a></li>
        
          <li><a href="../Sprockets/Mime.html">Sprockets::Mime</a></li>
        
          <li><a href="../Sprockets/NotImplementedError.html">Sprockets::NotImplementedError</a></li>
        
          <li><a href="../Sprockets/Paths.html">Sprockets::Paths</a></li>
        
          <li><a href="../Sprockets/ProcessedAsset.html">Sprockets::ProcessedAsset</a></li>
        
          <li><a href="../Sprockets/ProcessedAsset/DependencyFile.html">Sprockets::ProcessedAsset::DependencyFile</a></li>
        
          <li><a href="../Sprockets/Processing.html">Sprockets::Processing</a></li>
        
          <li><a href="../Sprockets/Processor.html">Sprockets::Processor</a></li>
        
          <li><a href="../Sprockets/SafetyColons.html">Sprockets::SafetyColons</a></li>
        
          <li><a href="../Sprockets/SassCacheStore.html">Sprockets::SassCacheStore</a></li>
        
          <li><a href="../Sprockets/SassCompressor.html">Sprockets::SassCompressor</a></li>
        
          <li><a href="../Sprockets/SassFunctions.html">Sprockets::SassFunctions</a></li>
        
          <li><a href="../Sprockets/SassImporter.html">Sprockets::SassImporter</a></li>
        
          <li><a href="../Sprockets/SassTemplate.html">Sprockets::SassTemplate</a></li>
        
          <li><a href="../Sprockets/ScssTemplate.html">Sprockets::ScssTemplate</a></li>
        
          <li><a href="../Sprockets/Server.html">Sprockets::Server</a></li>
        
          <li><a href="../Sprockets/StaticAsset.html">Sprockets::StaticAsset</a></li>
        
          <li><a href="../Sprockets/UglifierCompressor.html">Sprockets::UglifierCompressor</a></li>
        
          <li><a href="../Sprockets/UnserializeError.html">Sprockets::UnserializeError</a></li>
        
          <li><a href="../Sprockets/Utils.html">Sprockets::Utils</a></li>
        
          <li><a href="../Sprockets/YUICompressor.html">Sprockets::YUICompressor</a></li>
        
          <li><a href="../Rake.html">Rake</a></li>
        
          <li><a href="../Rake/SprocketsTask.html">Rake::SprocketsTask</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">Sprockets::Context</h1>

    <div id="description" class="description">
      
<p>`Context` provides helper methods to all `Tilt` processors. They are
typically accessed by ERB templates. You can mix in custom helpers by
injecting them into `Environment#context_class`. Do not mix them into
`Context` directly.</p>

<pre>environment.context_class.class_eval do
  include MyHelper
  def asset_url; end
end

&lt;%= asset_url &quot;foo.png&quot; %&gt;</pre>

<p>The `Context` also collects dependencies declared by assets. See
`DirectiveProcessor` for an example of this.</p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      

      
      <!-- Attributes -->
      <div id="attribute-method-details" class="method-section section">
        <h3 class="section-header">Attributes</h3>

        
        <div id="__LINE__-attribute-method" class="method-detail">
          <a name="__LINE__"></a>
          
          <a name="__LINE__="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">__LINE__</span><span
              class="attribute-access-type">[W]</span>
          </div>

          <div class="method-description">
          
          
          
          </div>
        </div>
        
        <div id="_dependency_assets-attribute-method" class="method-detail">
          <a name="_dependency_assets"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">_dependency_assets</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description">
          
          
          
          </div>
        </div>
        
        <div id="_dependency_paths-attribute-method" class="method-detail">
          <a name="_dependency_paths"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">_dependency_paths</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description">
          
          
          
          </div>
        </div>
        
        <div id="_required_paths-attribute-method" class="method-detail">
          <a name="_required_paths"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">_required_paths</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description">
          
          
          
          </div>
        </div>
        
        <div id="_stubbed_assets-attribute-method" class="method-detail">
          <a name="_stubbed_assets"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">_stubbed_assets</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description">
          
          
          
          </div>
        </div>
        
        <div id="environment-attribute-method" class="method-detail">
          <a name="environment"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">environment</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description">
          
          
          
          </div>
        </div>
        
        <div id="pathname-attribute-method" class="method-detail">
          <a name="pathname"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">pathname</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description">
          
          
          
          </div>
        </div>
        
      </div><!-- attribute-method-details -->
      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="new-method" class="method-detail ">
          <a name="method-c-new"></a>

          
          <div class="method-heading">
            <span class="method-name">new</span><span
              class="method-args">(environment, logical_path, pathname)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="new-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/context.rb, line 29</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">environment</span>, <span class="ruby-identifier">logical_path</span>, <span class="ruby-identifier">pathname</span>)
  <span class="ruby-ivar">@environment</span>  = <span class="ruby-identifier">environment</span>
  <span class="ruby-ivar">@logical_path</span> = <span class="ruby-identifier">logical_path</span>
  <span class="ruby-ivar">@pathname</span>     = <span class="ruby-identifier">pathname</span>
  <span class="ruby-ivar">@__LINE__</span>     = <span class="ruby-keyword">nil</span>

  <span class="ruby-ivar">@_required_paths</span>    = []
  <span class="ruby-ivar">@_stubbed_assets</span>    = <span class="ruby-constant">Set</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@_dependency_paths</span>  = <span class="ruby-constant">Set</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@_dependency_assets</span> = <span class="ruby-constant">Set</span>.<span class="ruby-identifier">new</span>([<span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">to_s</span>])
<span class="ruby-keyword">end</span></pre>
            </div><!-- new-source -->
            
          </div>

          

          
        </div><!-- new-method -->

      
      </div><!-- public-class-method-details -->
    
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="asset_data_uri-method" class="method-detail ">
          <a name="method-i-asset_data_uri"></a>

          
          <div class="method-heading">
            <span class="method-name">asset_data_uri</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns a Base64-encoded `data:` URI with the contents of the asset at the
specified path, and marks that path as a dependency of the current file.</p>

<p>Use `<a href="Context.html#method-i-asset_data_uri">asset_data_uri</a>`
from ERB with CSS or JavaScript assets:</p>

<pre>#logo { background: url(&lt;%= asset_data_uri 'logo.png' %&gt;) }

$('&lt;img&gt;').attr('src', '&lt;%= asset_data_uri 'avatar.jpg' %&gt;')</pre>
            

            
            <div class="method-source-code" id="asset_data_uri-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/context.rb, line 217</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">asset_data_uri</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">depend_on_asset</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">asset</span>  = <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">find_asset</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">base64</span> = <span class="ruby-constant">Base64</span>.<span class="ruby-identifier">encode64</span>(<span class="ruby-identifier">asset</span>.<span class="ruby-identifier">to_s</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/\s+/</span>, <span class="ruby-string">&quot;&quot;</span>)
  <span class="ruby-node">&quot;data:#{asset.content_type};base64,#{Rack::Utils.escape(base64)}&quot;</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- asset_data_uri-source -->
            
          </div>

          

          
        </div><!-- asset_data_uri-method -->

      
        <div id="asset_path-method" class="method-detail ">
          <a name="method-i-asset_path"></a>

          
          <div class="method-heading">
            <span class="method-name">asset_path</span><span
              class="method-args">(path, options = {})</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Expands logical path to full url to asset.</p>

<p>NOTE: This helper is currently not implemented and should be customized by
the application. Though, in the future, some basics implemention may be
provided with different methods that are required to be overridden.</p>
            

            
            <div class="method-source-code" id="asset_path-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/context.rb, line 230</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">asset_path</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">message</span> = <span class="ruby-string">Custom asset_path helper is not implementedExtend your environment context with a custom method.    environment.context_class.class_eval do      def asset_path(path, options = {})      end    end</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>, <span class="ruby-identifier">message</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- asset_path-source -->
            
          </div>

          

          
        </div><!-- asset_path-method -->

      
        <div id="asset_requirable-3F-method" class="method-detail ">
          <a name="method-i-asset_requirable-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">asset_requirable?</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Tests if target path is able to be safely required into the current
concatenation.</p>
            

            
            <div class="method-source-code" id="asset_requirable-3F-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/context.rb, line 162</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">asset_requirable?</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">pathname</span> = <span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">content_type</span> = <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">content_type_of</span>(<span class="ruby-identifier">pathname</span>)
  <span class="ruby-identifier">stat</span> = <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">stat</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">stat</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">stat</span>.<span class="ruby-identifier">file?</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">content_type</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">content_type</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">content_type</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- asset_requirable-3F-source -->
            
          </div>

          

          
        </div><!-- asset_requirable-3F-method -->

      
        <div id="audio_path-method" class="method-detail ">
          <a name="method-i-audio_path"></a>

          
          <div class="method-heading">
            <span class="method-name">audio_path</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Expand logical audio asset path.</p>
            

            
            <div class="method-source-code" id="audio_path-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/context.rb, line 255</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">audio_path</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">asset_path</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:audio</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- audio_path-source -->
            
          </div>

          

          
        </div><!-- audio_path-method -->

      
        <div id="content_type-method" class="method-detail ">
          <a name="method-i-content_type"></a>

          
          <div class="method-heading">
            <span class="method-name">content_type</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns content type of file</p>

<pre>'application/javascript'
'text/css'</pre>
            

            
            <div class="method-source-code" id="content_type-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/context.rb, line 64</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">content_type</span>
  <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">content_type_of</span>(<span class="ruby-identifier">pathname</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- content_type-source -->
            
          </div>

          

          
        </div><!-- content_type-method -->

      
        <div id="depend_on-method" class="method-detail ">
          <a name="method-i-depend_on"></a>

          
          <div class="method-heading">
            <span class="method-name">depend_on</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>`<a href="Context.html#method-i-depend_on">depend_on</a>` allows you to
state a dependency on a file without including it.</p>

<p>This is used for caching purposes. Any changes made to the dependency file
with invalidate the cache of the source file.</p>
            

            
            <div class="method-source-code" id="depend_on-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/context.rb, line 118</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">depend_on</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-ivar">@_dependency_paths</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- depend_on-source -->
            
          </div>

          

          
        </div><!-- depend_on-method -->

      
        <div id="depend_on_asset-method" class="method-detail ">
          <a name="method-i-depend_on_asset"></a>

          
          <div class="method-heading">
            <span class="method-name">depend_on_asset</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>`<a href="Context.html#method-i-depend_on_asset">depend_on_asset</a>`
allows you to state an asset dependency without including it.</p>

<p>This is used for caching purposes. Any changes that would invalidate the
dependency asset will invalidate the source file. Unlike `<a
href="Context.html#method-i-depend_on">depend_on</a>`, this will include
recursively include the target asset’s dependencies.</p>
            

            
            <div class="method-source-code" id="depend_on_asset-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/context.rb, line 130</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">depend_on_asset</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">filename</span> = <span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">path</span>).<span class="ruby-identifier">to_s</span>
  <span class="ruby-ivar">@_dependency_assets</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">filename</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- depend_on_asset-source -->
            
          </div>

          

          
        </div><!-- depend_on_asset-method -->

      
        <div id="evaluate-method" class="method-detail ">
          <a name="method-i-evaluate"></a>

          
          <div class="method-heading">
            <span class="method-name">evaluate</span><span
              class="method-args">(path, options = {})</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Reads `path` and runs processors on the file.</p>

<p>This allows you to capture the result of an asset and include it directly
in another.</p>

<pre>&lt;%= evaluate &quot;bar.js&quot; %&gt;</pre>
            

            
            <div class="method-source-code" id="evaluate-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/context.rb, line 177</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">evaluate</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">pathname</span>   = <span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">attributes</span> = <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">attributes_for</span>(<span class="ruby-identifier">pathname</span>)
  <span class="ruby-identifier">processors</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:processors</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">processors</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:data</span>]
    <span class="ruby-identifier">result</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:data</span>]
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:default_external_encoding</span>)
      <span class="ruby-identifier">mime_type</span> = <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">mime_types</span>(<span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">extname</span>)
      <span class="ruby-identifier">encoding</span>  = <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">encoding_for_mime_type</span>(<span class="ruby-identifier">mime_type</span>)
      <span class="ruby-identifier">result</span>    = <span class="ruby-constant">Sprockets</span><span class="ruby-operator">::</span><span class="ruby-constant">Utils</span>.<span class="ruby-identifier">read_unicode</span>(<span class="ruby-identifier">pathname</span>, <span class="ruby-identifier">encoding</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">result</span> = <span class="ruby-constant">Sprockets</span><span class="ruby-operator">::</span><span class="ruby-constant">Utils</span>.<span class="ruby-identifier">read_unicode</span>(<span class="ruby-identifier">pathname</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">processors</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">processor</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">template</span> = <span class="ruby-identifier">processor</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">to_s</span>) { <span class="ruby-identifier">result</span> }
      <span class="ruby-identifier">result</span> = <span class="ruby-identifier">template</span>.<span class="ruby-identifier">render</span>(<span class="ruby-keyword">self</span>, {})
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Exception</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
      <span class="ruby-identifier">annotate_exception!</span> <span class="ruby-identifier">e</span>
      <span class="ruby-identifier">raise</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">result</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- evaluate-source -->
            
          </div>

          

          
        </div><!-- evaluate-method -->

      
        <div id="font_path-method" class="method-detail ">
          <a name="method-i-font_path"></a>

          
          <div class="method-heading">
            <span class="method-name">font_path</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Expand logical font asset path.</p>
            

            
            <div class="method-source-code" id="font_path-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/context.rb, line 260</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">font_path</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">asset_path</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:font</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- font_path-source -->
            
          </div>

          

          
        </div><!-- font_path-method -->

      
        <div id="image_path-method" class="method-detail ">
          <a name="method-i-image_path"></a>

          
          <div class="method-heading">
            <span class="method-name">image_path</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Expand logical image asset path.</p>
            

            
            <div class="method-source-code" id="image_path-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/context.rb, line 245</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">image_path</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">asset_path</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:image</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- image_path-source -->
            
          </div>

          

          
        </div><!-- image_path-method -->

      
        <div id="javascript_path-method" class="method-detail ">
          <a name="method-i-javascript_path"></a>

          
          <div class="method-heading">
            <span class="method-name">javascript_path</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Expand logical javascript asset path.</p>
            

            
            <div class="method-source-code" id="javascript_path-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/context.rb, line 265</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">javascript_path</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">asset_path</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:javascript</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- javascript_path-source -->
            
          </div>

          

          
        </div><!-- javascript_path-method -->

      
        <div id="logical_path-method" class="method-detail ">
          <a name="method-i-logical_path"></a>

          
          <div class="method-heading">
            <span class="method-name">logical_path</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns logical path without any file extensions.</p>

<pre>'app/javascripts/application.js'
# =&gt; 'application'</pre>
            

            
            <div class="method-source-code" id="logical_path-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/context.rb, line 55</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">logical_path</span>
  <span class="ruby-ivar">@logical_path</span>.<span class="ruby-identifier">chomp</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">extname</span>(<span class="ruby-ivar">@logical_path</span>))
<span class="ruby-keyword">end</span></pre>
            </div><!-- logical_path-source -->
            
          </div>

          

          
        </div><!-- logical_path-method -->

      
        <div id="require_asset-method" class="method-detail ">
          <a name="method-i-require_asset"></a>

          
          <div class="method-heading">
            <span class="method-name">require_asset</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>`<a href="Context.html#method-i-require_asset">require_asset</a>` declares
`path` as a dependency of the file. The dependency will be inserted before
the file and will only be included once.</p>

<p>If ERB processing is enabled, you can use it to dynamically require assets.</p>

<pre>&lt;%= require_asset &quot;#{framework}.js&quot; %&gt;</pre>
            

            
            <div class="method-source-code" id="require_asset-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/context.rb, line 145</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">require_asset</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">pathname</span> = <span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value">:content_type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:self</span>)
  <span class="ruby-identifier">depend_on_asset</span>(<span class="ruby-identifier">pathname</span>)
  <span class="ruby-ivar">@_required_paths</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- require_asset-source -->
            
          </div>

          

          
        </div><!-- require_asset-method -->

      
        <div id="resolve-method" class="method-detail ">
          <a name="method-i-resolve"></a>

          
          <div class="method-heading">
            <span class="method-name">resolve</span><span
              class="method-args">(path, options = {}, &block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Given a logical path, `resolve` will find and return the fully expanded
path. Relative paths will also be resolved. An optional `:<a
href="Context.html#method-i-content_type">content_type</a>` restriction can
be supplied to restrict the search.</p>

<pre>resolve(&quot;foo.js&quot;)
# =&gt; &quot;/path/to/app/javascripts/foo.js&quot;

resolve(&quot;./bar.js&quot;)
# =&gt; &quot;/path/to/app/javascripts/bar.js&quot;</pre>
            

            
            <div class="method-source-code" id="resolve-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/context.rb, line 79</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span> = {}, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">pathname</span>   = <span class="ruby-constant">Pathname</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">attributes</span> = <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">attributes_for</span>(<span class="ruby-identifier">pathname</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">absolute?</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">stat</span>(<span class="ruby-identifier">pathname</span>)
      <span class="ruby-identifier">pathname</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">FileNotFound</span>, <span class="ruby-node">&quot;couldn't find file '#{pathname}'&quot;</span>
    <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">content_type</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:content_type</span>]
    <span class="ruby-identifier">content_type</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">content_type</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">content_type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:self</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">format_extension</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">content_type</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">content_type</span>
        <span class="ruby-identifier">raise</span> <span class="ruby-constant">ContentTypeMismatch</span>, <span class="ruby-node">&quot;#{path} is &quot;</span> <span class="ruby-operator">+</span>
          <span class="ruby-node">&quot;'#{attributes.content_type}', not '#{content_type}'&quot;</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">path</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">candidate</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">content_type</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">content_type_of</span>(<span class="ruby-identifier">candidate</span>)
        <span class="ruby-keyword">return</span> <span class="ruby-identifier">candidate</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">raise</span> <span class="ruby-constant">FileNotFound</span>, <span class="ruby-node">&quot;couldn't find file '#{path}'&quot;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">path</span>, {<span class="ruby-value">:base_path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">dirname</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">options</span>), &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- resolve-source -->
            
          </div>

          

          
        </div><!-- resolve-method -->

      
        <div id="root_path-method" class="method-detail ">
          <a name="method-i-root_path"></a>

          
          <div class="method-heading">
            <span class="method-name">root_path</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns the environment path that contains the file.</p>

<p>If `app/javascripts` and `app/stylesheets` are in your path, and current
file is `app/javascripts/foo/bar.js`, `<a
href="Context.html#method-i-root_path">root_path</a>` would return
`app/javascripts`.</p>
            

            
            <div class="method-source-code" id="root_path-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/context.rb, line 46</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">root_path</span>
  <span class="ruby-identifier">environment</span>.<span class="ruby-identifier">paths</span>.<span class="ruby-identifier">detect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span> <span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">to_s</span>[<span class="ruby-identifier">path</span>] }
<span class="ruby-keyword">end</span></pre>
            </div><!-- root_path-source -->
            
          </div>

          

          
        </div><!-- root_path-method -->

      
        <div id="stub_asset-method" class="method-detail ">
          <a name="method-i-stub_asset"></a>

          
          <div class="method-heading">
            <span class="method-name">stub_asset</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>`<a href="Context.html#method-i-stub_asset">stub_asset</a>` blacklists
`path` from being included in the bundle. `path` must be an asset which may
or may not already be included in the bundle.</p>
            

            
            <div class="method-source-code" id="stub_asset-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/context.rb, line 155</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">stub_asset</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-ivar">@_stubbed_assets</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">resolve</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value">:content_type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:self</span>).<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- stub_asset-source -->
            
          </div>

          

          
        </div><!-- stub_asset-method -->

      
        <div id="stylesheet_path-method" class="method-detail ">
          <a name="method-i-stylesheet_path"></a>

          
          <div class="method-heading">
            <span class="method-name">stylesheet_path</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Expand logical stylesheet asset path.</p>
            

            
            <div class="method-source-code" id="stylesheet_path-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/context.rb, line 270</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">stylesheet_path</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">asset_path</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:stylesheet</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- stylesheet_path-source -->
            
          </div>

          

          
        </div><!-- stylesheet_path-method -->

      
        <div id="video_path-method" class="method-detail ">
          <a name="method-i-video_path"></a>

          
          <div class="method-heading">
            <span class="method-name">video_path</span><span
              class="method-args">(path)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Expand logical video asset path.</p>
            

            
            <div class="method-source-code" id="video_path-source">
<pre>
<span class="ruby-comment"># File lib/sprockets/context.rb, line 250</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">video_path</span>(<span class="ruby-identifier">path</span>)
  <span class="ruby-identifier">asset_path</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:video</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- video_path-source -->
            
          </div>

          

          
        </div><!-- video_path-method -->

      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

