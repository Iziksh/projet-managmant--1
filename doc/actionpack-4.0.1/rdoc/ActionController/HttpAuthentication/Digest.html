<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>Module: ActionController::HttpAuthentication::Digest</title>

  <link rel="stylesheet" href="../../rdoc.css" type="text/css" media="screen" />

  <script src="../../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../../js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="module">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../../index.html">Home</a>
          <a href="../../index.html#classes">Classes</a>
          <a href="../../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="../../lib/action_controller/metal/http_authentication_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/action_controller/metal/http_authentication.rb">lib/action_controller/metal/http_authentication.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      

      

      
      <!-- Namespace Contents -->
      <div id="namespace-list-section" class="section">
        <h3 class="section-header">Namespace</h3>
        <ul class="link-list">
          
          <li><span class="type">MODULE</span> <a href="Digest/ControllerMethods.html">ActionController::HttpAuthentication::Digest::ControllerMethods</a></li>
          
        </ul>
      </div>
      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-i-authenticate">#authenticate</a></li>
          
          <li><a href="#method-i-authentication_header">#authentication_header</a></li>
          
          <li><a href="#method-i-authentication_request">#authentication_request</a></li>
          
          <li><a href="#method-i-decode_credentials">#decode_credentials</a></li>
          
          <li><a href="#method-i-decode_credentials_header">#decode_credentials_header</a></li>
          
          <li><a href="#method-i-encode_credentials">#encode_credentials</a></li>
          
          <li><a href="#method-i-expected_response">#expected_response</a></li>
          
          <li><a href="#method-i-ha1">#ha1</a></li>
          
          <li><a href="#method-i-nonce">#nonce</a></li>
          
          <li><a href="#method-i-opaque">#opaque</a></li>
          
          <li><a href="#method-i-secret_token">#secret_token</a></li>
          
          <li><a href="#method-i-validate_digest_response">#validate_digest_response</a></li>
          
          <li><a href="#method-i-validate_nonce">#validate_nonce</a></li>
          
        </ul>
      </div>
      

      
    </div>

    <div id="project-metadata">
      
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../../ActionDispatch.html">ActionDispatch</a></li>
        
          <li><a href="../../ActionDispatch/Assertions.html">ActionDispatch::Assertions</a></li>
        
          <li><a href="../../ActionDispatch/Assertions/DomAssertions.html">ActionDispatch::Assertions::DomAssertions</a></li>
        
          <li><a href="../../ActionDispatch/Assertions/ResponseAssertions.html">ActionDispatch::Assertions::ResponseAssertions</a></li>
        
          <li><a href="../../ActionDispatch/Assertions/RoutingAssertions.html">ActionDispatch::Assertions::RoutingAssertions</a></li>
        
          <li><a href="../../ActionDispatch/Assertions/SelectorAssertions.html">ActionDispatch::Assertions::SelectorAssertions</a></li>
        
          <li><a href="../../ActionDispatch/Assertions/TagAssertions.html">ActionDispatch::Assertions::TagAssertions</a></li>
        
          <li><a href="../../ActionDispatch/Callbacks.html">ActionDispatch::Callbacks</a></li>
        
          <li><a href="../../ActionDispatch/Cookies.html">ActionDispatch::Cookies</a></li>
        
          <li><a href="../../ActionDispatch/Cookies/ChainedCookieJars.html">ActionDispatch::Cookies::ChainedCookieJars</a></li>
        
          <li><a href="../../ActionDispatch/Cookies/VerifyAndUpgradeLegacySignedMessage.html">ActionDispatch::Cookies::VerifyAndUpgradeLegacySignedMessage</a></li>
        
          <li><a href="../../ActionDispatch/DebugExceptions.html">ActionDispatch::DebugExceptions</a></li>
        
          <li><a href="../../ActionDispatch/ExceptionWrapper.html">ActionDispatch::ExceptionWrapper</a></li>
        
          <li><a href="../../ActionDispatch/FileHandler.html">ActionDispatch::FileHandler</a></li>
        
          <li><a href="../../ActionDispatch/Flash.html">ActionDispatch::Flash</a></li>
        
          <li><a href="../../ActionDispatch/Flash/FlashHash.html">ActionDispatch::Flash::FlashHash</a></li>
        
          <li><a href="../../ActionDispatch/Http.html">ActionDispatch::Http</a></li>
        
          <li><a href="../../ActionDispatch/Http/Cache.html">ActionDispatch::Http::Cache</a></li>
        
          <li><a href="../../ActionDispatch/Http/Cache/Request.html">ActionDispatch::Http::Cache::Request</a></li>
        
          <li><a href="../../ActionDispatch/Http/Cache/Response.html">ActionDispatch::Http::Cache::Response</a></li>
        
          <li><a href="../../ActionDispatch/Http/FilterParameters.html">ActionDispatch::Http::FilterParameters</a></li>
        
          <li><a href="../../ActionDispatch/Http/FilterRedirect.html">ActionDispatch::Http::FilterRedirect</a></li>
        
          <li><a href="../../ActionDispatch/Http/Headers.html">ActionDispatch::Http::Headers</a></li>
        
          <li><a href="../../ActionDispatch/Http/MimeNegotiation.html">ActionDispatch::Http::MimeNegotiation</a></li>
        
          <li><a href="../../ActionDispatch/Http/ParameterFilter.html">ActionDispatch::Http::ParameterFilter</a></li>
        
          <li><a href="../../ActionDispatch/Http/Parameters.html">ActionDispatch::Http::Parameters</a></li>
        
          <li><a href="../../ActionDispatch/Http/URL.html">ActionDispatch::Http::URL</a></li>
        
          <li><a href="../../ActionDispatch/Http/UploadedFile.html">ActionDispatch::Http::UploadedFile</a></li>
        
          <li><a href="../../ActionDispatch/IllegalStateError.html">ActionDispatch::IllegalStateError</a></li>
        
          <li><a href="../../ActionDispatch/Integration.html">ActionDispatch::Integration</a></li>
        
          <li><a href="../../ActionDispatch/Integration.html">ActionDispatch::Integration</a></li>
        
          <li><a href="../../ActionDispatch/Integration/RequestHelpers.html">ActionDispatch::Integration::RequestHelpers</a></li>
        
          <li><a href="../../ActionDispatch/Integration/Runner.html">ActionDispatch::Integration::Runner</a></li>
        
          <li><a href="../../ActionDispatch/Integration/Session.html">ActionDispatch::Integration::Session</a></li>
        
          <li><a href="../../ActionDispatch/IntegrationTest.html">ActionDispatch::IntegrationTest</a></li>
        
          <li><a href="../../ActionDispatch/IntegrationTest.html">ActionDispatch::IntegrationTest</a></li>
        
          <li><a href="../../ActionDispatch/MiddlewareStack.html">ActionDispatch::MiddlewareStack</a></li>
        
          <li><a href="../../ActionDispatch/MiddlewareStack/Middleware.html">ActionDispatch::MiddlewareStack::Middleware</a></li>
        
          <li><a href="../../ActionDispatch/ParamsParser.html">ActionDispatch::ParamsParser</a></li>
        
          <li><a href="../../ActionDispatch/ParamsParser/ParseError.html">ActionDispatch::ParamsParser::ParseError</a></li>
        
          <li><a href="../../ActionDispatch/PublicExceptions.html">ActionDispatch::PublicExceptions</a></li>
        
          <li><a href="../../ActionDispatch/RailsEntityStore.html">ActionDispatch::RailsEntityStore</a></li>
        
          <li><a href="../../ActionDispatch/RailsMetaStore.html">ActionDispatch::RailsMetaStore</a></li>
        
          <li><a href="../../ActionDispatch/Reloader.html">ActionDispatch::Reloader</a></li>
        
          <li><a href="../../ActionDispatch/RemoteIp.html">ActionDispatch::RemoteIp</a></li>
        
          <li><a href="../../ActionDispatch/RemoteIp/GetIp.html">ActionDispatch::RemoteIp::GetIp</a></li>
        
          <li><a href="../../ActionDispatch/RemoteIp/IpSpoofAttackError.html">ActionDispatch::RemoteIp::IpSpoofAttackError</a></li>
        
          <li><a href="../../ActionDispatch/Request.html">ActionDispatch::Request</a></li>
        
          <li><a href="../../ActionDispatch/RequestId.html">ActionDispatch::RequestId</a></li>
        
          <li><a href="../../ActionDispatch/Response.html">ActionDispatch::Response</a></li>
        
          <li><a href="../../ActionDispatch/Routing.html">ActionDispatch::Routing</a></li>
        
          <li><a href="../../ActionDispatch/Routing.html">ActionDispatch::Routing</a></li>
        
          <li><a href="../../ActionDispatch/Routing/ConsoleFormatter.html">ActionDispatch::Routing::ConsoleFormatter</a></li>
        
          <li><a href="../../ActionDispatch/Routing/HtmlTableFormatter.html">ActionDispatch::Routing::HtmlTableFormatter</a></li>
        
          <li><a href="../../ActionDispatch/Routing/Mapper.html">ActionDispatch::Routing::Mapper</a></li>
        
          <li><a href="../../ActionDispatch/Routing/Mapper/Base.html">ActionDispatch::Routing::Mapper::Base</a></li>
        
          <li><a href="../../ActionDispatch/Routing/Mapper/Concerns.html">ActionDispatch::Routing::Mapper::Concerns</a></li>
        
          <li><a href="../../ActionDispatch/Routing/Mapper/HttpHelpers.html">ActionDispatch::Routing::Mapper::HttpHelpers</a></li>
        
          <li><a href="../../ActionDispatch/Routing/Mapper/Resources.html">ActionDispatch::Routing::Mapper::Resources</a></li>
        
          <li><a href="../../ActionDispatch/Routing/Mapper/Scoping.html">ActionDispatch::Routing::Mapper::Scoping</a></li>
        
          <li><a href="../../ActionDispatch/Routing/PathRedirect.html">ActionDispatch::Routing::PathRedirect</a></li>
        
          <li><a href="../../ActionDispatch/Routing/PolymorphicRoutes.html">ActionDispatch::Routing::PolymorphicRoutes</a></li>
        
          <li><a href="../../ActionDispatch/Routing/Redirection.html">ActionDispatch::Routing::Redirection</a></li>
        
          <li><a href="../../ActionDispatch/Routing/RouteWrapper.html">ActionDispatch::Routing::RouteWrapper</a></li>
        
          <li><a href="../../ActionDispatch/Routing/UrlFor.html">ActionDispatch::Routing::UrlFor</a></li>
        
          <li><a href="../../ActionDispatch/SSL.html">ActionDispatch::SSL</a></li>
        
          <li><a href="../../ActionDispatch/Session.html">ActionDispatch::Session</a></li>
        
          <li><a href="../../ActionDispatch/Session/AbstractStore.html">ActionDispatch::Session::AbstractStore</a></li>
        
          <li><a href="../../ActionDispatch/Session/CacheStore.html">ActionDispatch::Session::CacheStore</a></li>
        
          <li><a href="../../ActionDispatch/Session/Compatibility.html">ActionDispatch::Session::Compatibility</a></li>
        
          <li><a href="../../ActionDispatch/Session/CookieStore.html">ActionDispatch::Session::CookieStore</a></li>
        
          <li><a href="../../ActionDispatch/Session/MemCacheStore.html">ActionDispatch::Session::MemCacheStore</a></li>
        
          <li><a href="../../ActionDispatch/Session/StaleSessionCheck.html">ActionDispatch::Session::StaleSessionCheck</a></li>
        
          <li><a href="../../ActionDispatch/ShowExceptions.html">ActionDispatch::ShowExceptions</a></li>
        
          <li><a href="../../ActionDispatch/Static.html">ActionDispatch::Static</a></li>
        
          <li><a href="../../ActionDispatch/TestProcess.html">ActionDispatch::TestProcess</a></li>
        
          <li><a href="../../ActionDispatch/TestRequest.html">ActionDispatch::TestRequest</a></li>
        
          <li><a href="../../ActionDispatch/TestResponse.html">ActionDispatch::TestResponse</a></li>
        
          <li><a href="../../ActionController.html">ActionController</a></li>
        
          <li><a href="../../ActionController/ActionController.html">ActionController::ActionController</a></li>
        
          <li><a href="../../ActionController/ActionController/ActionController.html">ActionController::ActionController::ActionController</a></li>
        
          <li><a href="../../ActionController/Base.html">ActionController::Base</a></li>
        
          <li><a href="../../ActionController/Caching.html">ActionController::Caching</a></li>
        
          <li><a href="../../ActionController/Caching/ClassMethods.html">ActionController::Caching::ClassMethods</a></li>
        
          <li><a href="../../ActionController/Caching/ConfigMethods.html">ActionController::Caching::ConfigMethods</a></li>
        
          <li><a href="../../ActionController/Caching/Fragments.html">ActionController::Caching::Fragments</a></li>
        
          <li><a href="../../ActionController/ConditionalGet.html">ActionController::ConditionalGet</a></li>
        
          <li><a href="../../ActionController/ConditionalGet/ClassMethods.html">ActionController::ConditionalGet::ClassMethods</a></li>
        
          <li><a href="../../ActionController/Cookies.html">ActionController::Cookies</a></li>
        
          <li><a href="../../ActionController/DataStreaming.html">ActionController::DataStreaming</a></li>
        
          <li><a href="../../ActionController/Flash.html">ActionController::Flash</a></li>
        
          <li><a href="../../ActionController/Flash/ClassMethods.html">ActionController::Flash::ClassMethods</a></li>
        
          <li><a href="../../ActionController/ForceSSL.html">ActionController::ForceSSL</a></li>
        
          <li><a href="../../ActionController/ForceSSL/ClassMethods.html">ActionController::ForceSSL::ClassMethods</a></li>
        
          <li><a href="../../ActionController/Head.html">ActionController::Head</a></li>
        
          <li><a href="../../ActionController/Helpers.html">ActionController::Helpers</a></li>
        
          <li><a href="../../ActionController/Helpers/ClassMethods.html">ActionController::Helpers::ClassMethods</a></li>
        
          <li><a href="../../ActionController/HideActions.html">ActionController::HideActions</a></li>
        
          <li><a href="../../ActionController/HideActions/ClassMethods.html">ActionController::HideActions::ClassMethods</a></li>
        
          <li><a href="../../ActionController/HttpAuthentication.html">ActionController::HttpAuthentication</a></li>
        
          <li><a href="../../ActionController/HttpAuthentication/Basic.html">ActionController::HttpAuthentication::Basic</a></li>
        
          <li><a href="../../ActionController/HttpAuthentication/Basic/ControllerMethods.html">ActionController::HttpAuthentication::Basic::ControllerMethods</a></li>
        
          <li><a href="../../ActionController/HttpAuthentication/Basic/ControllerMethods/ClassMethods.html">ActionController::HttpAuthentication::Basic::ControllerMethods::ClassMethods</a></li>
        
          <li><a href="../../ActionController/HttpAuthentication/Digest.html">ActionController::HttpAuthentication::Digest</a></li>
        
          <li><a href="../../ActionController/HttpAuthentication/Digest/ControllerMethods.html">ActionController::HttpAuthentication::Digest::ControllerMethods</a></li>
        
          <li><a href="../../ActionController/HttpAuthentication/Token.html">ActionController::HttpAuthentication::Token</a></li>
        
          <li><a href="../../ActionController/HttpAuthentication/Token/ControllerMethods.html">ActionController::HttpAuthentication::Token::ControllerMethods</a></li>
        
          <li><a href="../../ActionController/ImplicitRender.html">ActionController::ImplicitRender</a></li>
        
          <li><a href="../../ActionController/Instrumentation.html">ActionController::Instrumentation</a></li>
        
          <li><a href="../../ActionController/Instrumentation/ClassMethods.html">ActionController::Instrumentation::ClassMethods</a></li>
        
          <li><a href="../../ActionController/Live.html">ActionController::Live</a></li>
        
          <li><a href="../../ActionController/Live/Response.html">ActionController::Live::Response</a></li>
        
          <li><a href="../../ActionController/LogSubscriber.html">ActionController::LogSubscriber</a></li>
        
          <li><a href="../../ActionController/Metal.html">ActionController::Metal</a></li>
        
          <li><a href="../../ActionController/Middleware.html">ActionController::Middleware</a></li>
        
          <li><a href="../../ActionController/Middleware/ActionMiddleware.html">ActionController::Middleware::ActionMiddleware</a></li>
        
          <li><a href="../../ActionController/MimeResponds.html">ActionController::MimeResponds</a></li>
        
          <li><a href="../../ActionController/MimeResponds/ClassMethods.html">ActionController::MimeResponds::ClassMethods</a></li>
        
          <li><a href="../../ActionController/MimeResponds/Collector.html">ActionController::MimeResponds::Collector</a></li>
        
          <li><a href="../../ActionController/ModelNaming.html">ActionController::ModelNaming</a></li>
        
          <li><a href="../../ActionController/ParameterMissing.html">ActionController::ParameterMissing</a></li>
        
          <li><a href="../../ActionController/Parameters.html">ActionController::Parameters</a></li>
        
          <li><a href="../../ActionController/ParamsWrapper.html">ActionController::ParamsWrapper</a></li>
        
          <li><a href="../../ActionController/ParamsWrapper/ClassMethods.html">ActionController::ParamsWrapper::ClassMethods</a></li>
        
          <li><a href="../../ActionController/RackDelegation.html">ActionController::RackDelegation</a></li>
        
          <li><a href="../../ActionController/Railties.html">ActionController::Railties</a></li>
        
          <li><a href="../../ActionController/Railties/Helpers.html">ActionController::Railties::Helpers</a></li>
        
          <li><a href="../../ActionController/RecordIdentifier.html">ActionController::RecordIdentifier</a></li>
        
          <li><a href="../../ActionController/Redirecting.html">ActionController::Redirecting</a></li>
        
          <li><a href="../../ActionController/Renderers.html">ActionController::Renderers</a></li>
        
          <li><a href="../../ActionController/Renderers/All.html">ActionController::Renderers::All</a></li>
        
          <li><a href="../../ActionController/Renderers/ClassMethods.html">ActionController::Renderers::ClassMethods</a></li>
        
          <li><a href="../../ActionController/Rendering.html">ActionController::Rendering</a></li>
        
          <li><a href="../../ActionController/RequestForgeryProtection.html">ActionController::RequestForgeryProtection</a></li>
        
          <li><a href="../../ActionController/RequestForgeryProtection/ClassMethods.html">ActionController::RequestForgeryProtection::ClassMethods</a></li>
        
          <li><a href="../../ActionController/RequestForgeryProtection/ProtectionMethods.html">ActionController::RequestForgeryProtection::ProtectionMethods</a></li>
        
          <li><a href="../../ActionController/RequestForgeryProtection/ProtectionMethods/Exception.html">ActionController::RequestForgeryProtection::ProtectionMethods::Exception</a></li>
        
          <li><a href="../../ActionController/RequestForgeryProtection/ProtectionMethods/NullSession.html">ActionController::RequestForgeryProtection::ProtectionMethods::NullSession</a></li>
        
          <li><a href="../../ActionController/RequestForgeryProtection/ProtectionMethods/ResetSession.html">ActionController::RequestForgeryProtection::ProtectionMethods::ResetSession</a></li>
        
          <li><a href="../../ActionController/Rescue.html">ActionController::Rescue</a></li>
        
          <li><a href="../../ActionController/Responder.html">ActionController::Responder</a></li>
        
          <li><a href="../../ActionController/Streaming.html">ActionController::Streaming</a></li>
        
          <li><a href="../../ActionController/StrongParameters.html">ActionController::StrongParameters</a></li>
        
          <li><a href="../../ActionController/TemplateAssertions.html">ActionController::TemplateAssertions</a></li>
        
          <li><a href="../../ActionController/TestCase.html">ActionController::TestCase</a></li>
        
          <li><a href="../../ActionController/TestCase/Behavior.html">ActionController::TestCase::Behavior</a></li>
        
          <li><a href="../../ActionController/TestCase/Behavior/ClassMethods.html">ActionController::TestCase::Behavior::ClassMethods</a></li>
        
          <li><a href="../../ActionController/TestCase/RaiseActionExceptions.html">ActionController::TestCase::RaiseActionExceptions</a></li>
        
          <li><a href="../../ActionController/TestResponse.html">ActionController::TestResponse</a></li>
        
          <li><a href="../../ActionController/Testing.html">ActionController::Testing</a></li>
        
          <li><a href="../../ActionController/Testing/ClassMethods.html">ActionController::Testing::ClassMethods</a></li>
        
          <li><a href="../../ActionController/UnpermittedParameters.html">ActionController::UnpermittedParameters</a></li>
        
          <li><a href="../../ActionController/UrlFor.html">ActionController::UrlFor</a></li>
        
          <li><a href="../../ActionView.html">ActionView</a></li>
        
          <li><a href="../../ActionView/Base.html">ActionView::Base</a></li>
        
          <li><a href="../../ActionView/Context.html">ActionView::Context</a></li>
        
          <li><a href="../../ActionView/DependencyTracker.html">ActionView::DependencyTracker</a></li>
        
          <li><a href="../../ActionView/DependencyTracker/ERBTracker.html">ActionView::DependencyTracker::ERBTracker</a></li>
        
          <li><a href="../../ActionView/Digestor.html">ActionView::Digestor</a></li>
        
          <li><a href="../../ActionView/FileSystemResolver.html">ActionView::FileSystemResolver</a></li>
        
          <li><a href="../../ActionView/FixtureResolver.html">ActionView::FixtureResolver</a></li>
        
          <li><a href="../../ActionView/Helpers.html">ActionView::Helpers</a></li>
        
          <li><a href="../../ActionView/Helpers/ActiveModelHelper.html">ActionView::Helpers::ActiveModelHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/ActiveModelInstanceTag.html">ActionView::Helpers::ActiveModelInstanceTag</a></li>
        
          <li><a href="../../ActionView/Helpers/AssetTagHelper.html">ActionView::Helpers::AssetTagHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/AssetUrlHelper.html">ActionView::Helpers::AssetUrlHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/AtomFeedHelper.html">ActionView::Helpers::AtomFeedHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/CacheHelper.html">ActionView::Helpers::CacheHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/CaptureHelper.html">ActionView::Helpers::CaptureHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/CsrfHelper.html">ActionView::Helpers::CsrfHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/DateHelper.html">ActionView::Helpers::DateHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/DebugHelper.html">ActionView::Helpers::DebugHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/FormBuilder.html">ActionView::Helpers::FormBuilder</a></li>
        
          <li><a href="../../ActionView/Helpers/FormHelper.html">ActionView::Helpers::FormHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/FormOptionsHelper.html">ActionView::Helpers::FormOptionsHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/FormTagHelper.html">ActionView::Helpers::FormTagHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/JavaScriptHelper.html">ActionView::Helpers::JavaScriptHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/NumberHelper.html">ActionView::Helpers::NumberHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/NumberHelper/InvalidNumberError.html">ActionView::Helpers::NumberHelper::InvalidNumberError</a></li>
        
          <li><a href="../../ActionView/Helpers/OutputSafetyHelper.html">ActionView::Helpers::OutputSafetyHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/RecordTagHelper.html">ActionView::Helpers::RecordTagHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/RenderingHelper.html">ActionView::Helpers::RenderingHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/SanitizeHelper.html">ActionView::Helpers::SanitizeHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/TagHelper.html">ActionView::Helpers::TagHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/TextHelper.html">ActionView::Helpers::TextHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/TranslationHelper.html">ActionView::Helpers::TranslationHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/UrlHelper.html">ActionView::Helpers::UrlHelper</a></li>
        
          <li><a href="../../ActionView/Helpers/UrlHelper/ClassMethods.html">ActionView::Helpers::UrlHelper::ClassMethods</a></li>
        
          <li><a href="../../ActionView/LogSubscriber.html">ActionView::LogSubscriber</a></li>
        
          <li><a href="../../ActionView/LookupContext.html">ActionView::LookupContext</a></li>
        
          <li><a href="../../ActionView/LookupContext/DetailsCache.html">ActionView::LookupContext::DetailsCache</a></li>
        
          <li><a href="../../ActionView/LookupContext/ViewPaths.html">ActionView::LookupContext::ViewPaths</a></li>
        
          <li><a href="../../ActionView/ModelNaming.html">ActionView::ModelNaming</a></li>
        
          <li><a href="../../ActionView/NullResolver.html">ActionView::NullResolver</a></li>
        
          <li><a href="../../ActionView/PartialRenderer.html">ActionView::PartialRenderer</a></li>
        
          <li><a href="../../ActionView/RecordIdentifier.html">ActionView::RecordIdentifier</a></li>
        
          <li><a href="../../ActionView/Renderer.html">ActionView::Renderer</a></li>
        
          <li><a href="../../ActionView/Resolver.html">ActionView::Resolver</a></li>
        
          <li><a href="../../ActionView/Resolver/Cache.html">ActionView::Resolver::Cache</a></li>
        
          <li><a href="../../ActionView/Resolver/Cache/SmallCache.html">ActionView::Resolver::Cache::SmallCache</a></li>
        
          <li><a href="../../ActionView/Resolver/Path.html">ActionView::Resolver::Path</a></li>
        
          <li><a href="../../ActionView/RoutingUrlFor.html">ActionView::RoutingUrlFor</a></li>
        
          <li><a href="../../ActionView/Template.html">ActionView::Template</a></li>
        
          <li><a href="../../ActionView/Template/Handlers.html">ActionView::Template::Handlers</a></li>
        
          <li><a href="../../ActionView/Template/Handlers/Builder.html">ActionView::Template::Handlers::Builder</a></li>
        
          <li><a href="../../ActionView/Template/Handlers/ERB.html">ActionView::Template::Handlers::ERB</a></li>
        
          <li><a href="../../ActionView/Template/Handlers/Erubis.html">ActionView::Template::Handlers::Erubis</a></li>
        
          <li><a href="../../ActionView/Template/Handlers/Raw.html">ActionView::Template::Handlers::Raw</a></li>
        
          <li><a href="../../ActionView/Template/Types.html">ActionView::Template::Types</a></li>
        
          <li><a href="../../ActionView/Template/Types/Type.html">ActionView::Template::Types::Type</a></li>
        
          <li><a href="../../ActionView/TestCase.html">ActionView::TestCase</a></li>
        
          <li><a href="../../ActionView/TestCase/Behavior.html">ActionView::TestCase::Behavior</a></li>
        
          <li><a href="../../ActionView/TestCase/Behavior/ClassMethods.html">ActionView::TestCase::Behavior::ClassMethods</a></li>
        
          <li><a href="../../ActionView/TestCase/Behavior/Locals.html">ActionView::TestCase::Behavior::Locals</a></li>
        
          <li><a href="../../ActionView/TestCase/Behavior/RenderedViewsCollection.html">ActionView::TestCase::Behavior::RenderedViewsCollection</a></li>
        
          <li><a href="../../ActionView/TestCase/TestController.html">ActionView::TestCase::TestController</a></li>
        
          <li><a href="../../AbstractController.html">AbstractController</a></li>
        
          <li><a href="../../AbstractController/Base.html">AbstractController::Base</a></li>
        
          <li><a href="../../AbstractController/Callbacks.html">AbstractController::Callbacks</a></li>
        
          <li><a href="../../AbstractController/Callbacks/ClassMethods.html">AbstractController::Callbacks::ClassMethods</a></li>
        
          <li><a href="../../AbstractController/Collector.html">AbstractController::Collector</a></li>
        
          <li><a href="../../AbstractController/DoubleRenderError.html">AbstractController::DoubleRenderError</a></li>
        
          <li><a href="../../AbstractController/Helpers.html">AbstractController::Helpers</a></li>
        
          <li><a href="../../AbstractController/Helpers/ClassMethods.html">AbstractController::Helpers::ClassMethods</a></li>
        
          <li><a href="../../AbstractController/Helpers/ClassMethods/MissingHelperError.html">AbstractController::Helpers::ClassMethods::MissingHelperError</a></li>
        
          <li><a href="../../AbstractController/Layouts.html">AbstractController::Layouts</a></li>
        
          <li><a href="../../AbstractController/Layouts/ClassMethods.html">AbstractController::Layouts::ClassMethods</a></li>
        
          <li><a href="../../AbstractController/Railties.html">AbstractController::Railties</a></li>
        
          <li><a href="../../AbstractController/Railties/RoutesHelpers.html">AbstractController::Railties::RoutesHelpers</a></li>
        
          <li><a href="../../AbstractController/Rendering.html">AbstractController::Rendering</a></li>
        
          <li><a href="../../AbstractController/Rendering/ClassMethods.html">AbstractController::Rendering::ClassMethods</a></li>
        
          <li><a href="../../AbstractController/Translation.html">AbstractController::Translation</a></li>
        
          <li><a href="../../AbstractController/UrlFor.html">AbstractController::UrlFor</a></li>
        
          <li><a href="../../AbstractController/UrlFor/ClassMethods.html">AbstractController::UrlFor::ClassMethods</a></li>
        
          <li><a href="../../AbstractController/ViewPaths.html">AbstractController::ViewPaths</a></li>
        
          <li><a href="../../AbstractController/ViewPaths/ClassMethods.html">AbstractController::ViewPaths::ClassMethods</a></li>
        
          <li><a href="../../HTML.html">HTML</a></li>
        
          <li><a href="../../HTML/FullSanitizer.html">HTML::FullSanitizer</a></li>
        
          <li><a href="../../HTML/LinkSanitizer.html">HTML::LinkSanitizer</a></li>
        
          <li><a href="../../HTML/Sanitizer.html">HTML::Sanitizer</a></li>
        
          <li><a href="../../HTML/Selector.html">HTML::Selector</a></li>
        
          <li><a href="../../HTML/Tag.html">HTML::Tag</a></li>
        
          <li><a href="../../HTML/WhiteListSanitizer.html">HTML::WhiteListSanitizer</a></li>
        
          <li><a href="../../Mime.html">Mime</a></li>
        
          <li><a href="../../Mime/Mimes.html">Mime::Mimes</a></li>
        
          <li><a href="../../Mime/NullType.html">Mime::NullType</a></li>
        
          <li><a href="../../Mime/Type.html">Mime::Type</a></li>
        
          <li><a href="../../Object.html">Object</a></li>
        
          <li><a href="../../ActionDispatch/Integration.html">Object::Integration</a></li>
        
          <li><a href="../../ActionDispatch/IntegrationTest.html">Object::IntegrationTest</a></li>
        
          <li><a href="../../ActionDispatch/Routing.html">Object::Routing</a></li>
        
          <li><a href="../../I18n.html">I18n</a></li>
        
          <li><a href="../../I18n/ExceptionHandler.html">I18n::ExceptionHandler</a></li>
        
          <li><a href="../../ActionPack.html">ActionPack</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="module">ActionController::HttpAuthentication::Digest</h1>

    <div id="description" class="description">
      
<p>Makes it dead easy to do HTTP Digest authentication.</p>

<h3>Simple Digest example</h3>

<pre>require 'digest/md5'
class PostsController &lt; ApplicationController
  REALM = &quot;SuperSecret&quot;
  USERS = {&quot;dhh&quot; =&gt; &quot;secret&quot;, #plain text password
           &quot;dap&quot; =&gt; Digest::MD5.hexdigest([&quot;dap&quot;,REALM,&quot;secret&quot;].join(&quot;:&quot;))}  #ha1 digest password

  before_action :authenticate, except: [:index]

  def index
    render text: &quot;Everyone can see me!&quot;
  end

  def edit
    render text: &quot;I'm only accessible if you know the password&quot;
  end

  private
    def authenticate
      authenticate_or_request_with_http_digest(REALM) do |username|
        USERS[username]
      end
    end
end</pre>

<h3>Notes</h3>

<p>The <tt>authenticate_or_request_with_http_digest</tt> block must return the
user’s password or the ha1 digest hash so the framework can appropriately
hash to check the user’s credentials. Returning <tt>nil</tt> will cause
authentication to fail.</p>

<p>Storing the ha1 hash: MD5(username:realm:password), is better than storing
a plain password. If the password file or database is compromised, the
attacker would be able to use the ha1 hash to authenticate as the user at
this <tt>realm</tt>, but would not have the user’s password to try using at
other sites.</p>

<p>In rare instances, web servers or front proxies strip authorization headers
before they reach your application. You can debug this situation by logging
all environment variables, and check for HTTP_AUTHORIZATION, amongst
others.</p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      

      

      <!-- Methods -->
      
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="authenticate-method" class="method-detail ">
          <a name="method-i-authenticate"></a>

          
          <div class="method-heading">
            <span class="method-name">authenticate</span><span
              class="method-args">(request, realm, &password_procedure)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns false on a valid response, true otherwise</p>
            

            
            <div class="method-source-code" id="authenticate-source">
<pre>
<span class="ruby-comment"># File lib/action_controller/metal/http_authentication.rb, line 179</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">authenticate</span>(<span class="ruby-identifier">request</span>, <span class="ruby-identifier">realm</span>, &amp;<span class="ruby-identifier">password_procedure</span>)
  <span class="ruby-identifier">request</span>.<span class="ruby-identifier">authorization</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">validate_digest_response</span>(<span class="ruby-identifier">request</span>, <span class="ruby-identifier">realm</span>, &amp;<span class="ruby-identifier">password_procedure</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- authenticate-source -->
            
          </div>

          

          
        </div><!-- authenticate-method -->

      
        <div id="authentication_header-method" class="method-detail ">
          <a name="method-i-authentication_header"></a>

          
          <div class="method-heading">
            <span class="method-name">authentication_header</span><span
              class="method-args">(controller, realm)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="authentication_header-source">
<pre>
<span class="ruby-comment"># File lib/action_controller/metal/http_authentication.rb, line 237</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">authentication_header</span>(<span class="ruby-identifier">controller</span>, <span class="ruby-identifier">realm</span>)
  <span class="ruby-identifier">secret_key</span> = <span class="ruby-identifier">secret_token</span>(<span class="ruby-identifier">controller</span>.<span class="ruby-identifier">request</span>)
  <span class="ruby-identifier">nonce</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">nonce</span>(<span class="ruby-identifier">secret_key</span>)
  <span class="ruby-identifier">opaque</span> = <span class="ruby-identifier">opaque</span>(<span class="ruby-identifier">secret_key</span>)
  <span class="ruby-identifier">controller</span>.<span class="ruby-identifier">headers</span>[<span class="ruby-string">&quot;WWW-Authenticate&quot;</span>] = <span class="ruby-node">%(Digest realm=&quot;#{realm}&quot;, qop=&quot;auth&quot;, algorithm=MD5, nonce=&quot;#{nonce}&quot;, opaque=&quot;#{opaque}&quot;)</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- authentication_header-source -->
            
          </div>

          

          
        </div><!-- authentication_header-method -->

      
        <div id="authentication_request-method" class="method-detail ">
          <a name="method-i-authentication_request"></a>

          
          <div class="method-heading">
            <span class="method-name">authentication_request</span><span
              class="method-args">(controller, realm, message = nil)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="authentication_request-source">
<pre>
<span class="ruby-comment"># File lib/action_controller/metal/http_authentication.rb, line 244</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">authentication_request</span>(<span class="ruby-identifier">controller</span>, <span class="ruby-identifier">realm</span>, <span class="ruby-identifier">message</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">message</span> <span class="ruby-operator">||=</span> <span class="ruby-string">&quot;HTTP Digest: Access denied.\n&quot;</span>
  <span class="ruby-identifier">authentication_header</span>(<span class="ruby-identifier">controller</span>, <span class="ruby-identifier">realm</span>)
  <span class="ruby-identifier">controller</span>.<span class="ruby-identifier">response_body</span> = <span class="ruby-identifier">message</span>
  <span class="ruby-identifier">controller</span>.<span class="ruby-identifier">status</span> = <span class="ruby-value">401</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- authentication_request-source -->
            
          </div>

          

          
        </div><!-- authentication_request-method -->

      
        <div id="decode_credentials-method" class="method-detail ">
          <a name="method-i-decode_credentials"></a>

          
          <div class="method-heading">
            <span class="method-name">decode_credentials</span><span
              class="method-args">(header)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="decode_credentials-source">
<pre>
<span class="ruby-comment"># File lib/action_controller/metal/http_authentication.rb, line 230</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_credentials</span>(<span class="ruby-identifier">header</span>)
  <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">HashWithIndifferentAccess</span>[<span class="ruby-identifier">header</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/^Digest\s+/</span>, <span class="ruby-string">''</span>).<span class="ruby-identifier">split</span>(<span class="ruby-string">','</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pair</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span> = <span class="ruby-identifier">pair</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">'='</span>, <span class="ruby-value">2</span>)
    [<span class="ruby-identifier">key</span>.<span class="ruby-identifier">strip</span>, <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/^&quot;|&quot;$/</span>,<span class="ruby-string">''</span>).<span class="ruby-identifier">delete</span>(<span class="ruby-string">'\'</span>)]
  <span class="ruby-keyword">end</span>]
<span class="ruby-keyword">end</span></pre>
            </div><!-- decode_credentials-source -->
            
          </div>

          

          
        </div><!-- decode_credentials-method -->

      
        <div id="decode_credentials_header-method" class="method-detail ">
          <a name="method-i-decode_credentials_header"></a>

          
          <div class="method-heading">
            <span class="method-name">decode_credentials_header</span><span
              class="method-args">(request)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="decode_credentials_header-source">
<pre>
<span class="ruby-comment"># File lib/action_controller/metal/http_authentication.rb, line 226</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">decode_credentials_header</span>(<span class="ruby-identifier">request</span>)
  <span class="ruby-identifier">decode_credentials</span>(<span class="ruby-identifier">request</span>.<span class="ruby-identifier">authorization</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- decode_credentials_header-source -->
            
          </div>

          

          
        </div><!-- decode_credentials_header-method -->

      
        <div id="encode_credentials-method" class="method-detail ">
          <a name="method-i-encode_credentials"></a>

          
          <div class="method-heading">
            <span class="method-name">encode_credentials</span><span
              class="method-args">(http_method, credentials, password, password_is_ha1)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="encode_credentials-source">
<pre>
<span class="ruby-comment"># File lib/action_controller/metal/http_authentication.rb, line 221</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">encode_credentials</span>(<span class="ruby-identifier">http_method</span>, <span class="ruby-identifier">credentials</span>, <span class="ruby-identifier">password</span>, <span class="ruby-identifier">password_is_ha1</span>)
  <span class="ruby-identifier">credentials</span>[<span class="ruby-value">:response</span>] = <span class="ruby-identifier">expected_response</span>(<span class="ruby-identifier">http_method</span>, <span class="ruby-identifier">credentials</span>[<span class="ruby-value">:uri</span>], <span class="ruby-identifier">credentials</span>, <span class="ruby-identifier">password</span>, <span class="ruby-identifier">password_is_ha1</span>)
  <span class="ruby-string">&quot;Digest &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">credentials</span>.<span class="ruby-identifier">sort_by</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_s</span> }.<span class="ruby-identifier">map</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;#{v[0]}='#{v[1]}'&quot;</span> }.<span class="ruby-identifier">join</span>(<span class="ruby-string">', '</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- encode_credentials-source -->
            
          </div>

          

          
        </div><!-- encode_credentials-method -->

      
        <div id="expected_response-method" class="method-detail ">
          <a name="method-i-expected_response"></a>

          
          <div class="method-heading">
            <span class="method-name">expected_response</span><span
              class="method-args">(http_method, uri, credentials, password, password_is_ha1=true)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns the expected response for a request of <tt>http_method</tt> to
<tt>uri</tt> with the decoded <tt>credentials</tt> and the expected
<tt>password</tt> Optional parameter <tt>password_is_ha1</tt> is set to
<tt>true</tt> by default, since best practice is to store ha1 digest
instead of a plain-text password.</p>
            

            
            <div class="method-source-code" id="expected_response-source">
<pre>
<span class="ruby-comment"># File lib/action_controller/metal/http_authentication.rb, line 211</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">expected_response</span>(<span class="ruby-identifier">http_method</span>, <span class="ruby-identifier">uri</span>, <span class="ruby-identifier">credentials</span>, <span class="ruby-identifier">password</span>, <span class="ruby-identifier">password_is_ha1</span>=<span class="ruby-keyword">true</span>)
  <span class="ruby-identifier">ha1</span> = <span class="ruby-identifier">password_is_ha1</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">password</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">ha1</span>(<span class="ruby-identifier">credentials</span>, <span class="ruby-identifier">password</span>)
  <span class="ruby-identifier">ha2</span> = <span class="ruby-operator">::</span><span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">MD5</span>.<span class="ruby-identifier">hexdigest</span>([<span class="ruby-identifier">http_method</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">upcase</span>, <span class="ruby-identifier">uri</span>].<span class="ruby-identifier">join</span>(<span class="ruby-string">':'</span>))
  <span class="ruby-operator">::</span><span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">MD5</span>.<span class="ruby-identifier">hexdigest</span>([<span class="ruby-identifier">ha1</span>, <span class="ruby-identifier">credentials</span>[<span class="ruby-value">:nonce</span>], <span class="ruby-identifier">credentials</span>[<span class="ruby-value">:nc</span>], <span class="ruby-identifier">credentials</span>[<span class="ruby-value">:cnonce</span>], <span class="ruby-identifier">credentials</span>[<span class="ruby-value">:qop</span>], <span class="ruby-identifier">ha2</span>].<span class="ruby-identifier">join</span>(<span class="ruby-string">':'</span>))
<span class="ruby-keyword">end</span></pre>
            </div><!-- expected_response-source -->
            
          </div>

          

          
        </div><!-- expected_response-method -->

      
        <div id="ha1-method" class="method-detail ">
          <a name="method-i-ha1"></a>

          
          <div class="method-heading">
            <span class="method-name">ha1</span><span
              class="method-args">(credentials, password)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="ha1-source">
<pre>
<span class="ruby-comment"># File lib/action_controller/metal/http_authentication.rb, line 217</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">ha1</span>(<span class="ruby-identifier">credentials</span>, <span class="ruby-identifier">password</span>)
  <span class="ruby-operator">::</span><span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">MD5</span>.<span class="ruby-identifier">hexdigest</span>([<span class="ruby-identifier">credentials</span>[<span class="ruby-value">:username</span>], <span class="ruby-identifier">credentials</span>[<span class="ruby-value">:realm</span>], <span class="ruby-identifier">password</span>].<span class="ruby-identifier">join</span>(<span class="ruby-string">':'</span>))
<span class="ruby-keyword">end</span></pre>
            </div><!-- ha1-source -->
            
          </div>

          

          
        </div><!-- ha1-method -->

      
        <div id="nonce-method" class="method-detail ">
          <a name="method-i-nonce"></a>

          
          <div class="method-heading">
            <span class="method-name">nonce</span><span
              class="method-args">(secret_key, time = Time.now)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Uses an MD5 digest based on time to generate a value to be used only once.</p>

<p>A server-specified data string which should be uniquely generated each time
a 401 response is made. It is recommended that this string be base64 or
hexadecimal data. Specifically, since the string is passed in the header
lines as a quoted string, the double-quote character is not allowed.</p>

<p>The contents of the nonce are implementation dependent. The quality of the
implementation depends on a good choice. A nonce might, for example, be
constructed as the base 64 encoding of</p>

<pre>time-stamp H(time-stamp &quot;:&quot; ETag &quot;:&quot; private-key)</pre>

<p>where time-stamp is a server-generated time or other non-repeating value,
ETag is the value of the HTTP ETag header associated with the requested
entity, and private-key is data known only to the server. With a nonce of
this form a server would recalculate the hash portion after receiving the
client authentication header and reject the request if it did not match the
nonce from that header or if the time-stamp value is not recent enough. In
this way the server can limit the time of the nonce’s validity. The
inclusion of the ETag prevents a replay request for an updated version of
the resource. (Note: including the IP address of the client in the nonce
would appear to offer the server the ability to limit the reuse of the
nonce to the same client that originally got it. However, that would break
proxy farms, where requests from a single user often go through different
proxies in the farm. Also, IP address spoofing is not that hard.)</p>

<p>An implementation might choose not to accept a previously used nonce or a
previously used digest, in order to protect against a replay attack. Or, an
implementation might choose to use one-time nonces or digests for POST,
PUT, or PATCH requests and a time-stamp for GET requests. For more details
on the issues involved see Section 4 of this document.</p>

<p>The nonce is opaque to the client. Composed of Time, and hash of Time with
secret key from the Rails session secret generated upon creation of
project. Ensures the time cannot be modified by client.</p>
            

            
            <div class="method-source-code" id="nonce-source">
<pre>
<span class="ruby-comment"># File lib/action_controller/metal/http_authentication.rb, line 289</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">nonce</span>(<span class="ruby-identifier">secret_key</span>, <span class="ruby-identifier">time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>)
  <span class="ruby-identifier">t</span> = <span class="ruby-identifier">time</span>.<span class="ruby-identifier">to_i</span>
  <span class="ruby-identifier">hashed</span> = [<span class="ruby-identifier">t</span>, <span class="ruby-identifier">secret_key</span>]
  <span class="ruby-identifier">digest</span> = <span class="ruby-operator">::</span><span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">MD5</span>.<span class="ruby-identifier">hexdigest</span>(<span class="ruby-identifier">hashed</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;:&quot;</span>))
  <span class="ruby-operator">::</span><span class="ruby-constant">Base64</span>.<span class="ruby-identifier">strict_encode64</span>(<span class="ruby-node">&quot;#{t}:#{digest}&quot;</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- nonce-source -->
            
          </div>

          

          
        </div><!-- nonce-method -->

      
        <div id="opaque-method" class="method-detail ">
          <a name="method-i-opaque"></a>

          
          <div class="method-heading">
            <span class="method-name">opaque</span><span
              class="method-args">(secret_key)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Opaque based on random generation - but changing each request?</p>
            

            
            <div class="method-source-code" id="opaque-source">
<pre>
<span class="ruby-comment"># File lib/action_controller/metal/http_authentication.rb, line 308</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">opaque</span>(<span class="ruby-identifier">secret_key</span>)
  <span class="ruby-operator">::</span><span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">MD5</span>.<span class="ruby-identifier">hexdigest</span>(<span class="ruby-identifier">secret_key</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- opaque-source -->
            
          </div>

          

          
        </div><!-- opaque-method -->

      
        <div id="secret_token-method" class="method-detail ">
          <a name="method-i-secret_token"></a>

          
          <div class="method-heading">
            <span class="method-name">secret_token</span><span
              class="method-args">(request)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="secret_token-source">
<pre>
<span class="ruby-comment"># File lib/action_controller/metal/http_authentication.rb, line 251</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">secret_token</span>(<span class="ruby-identifier">request</span>)
  <span class="ruby-identifier">key_generator</span>  = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-string">&quot;action_dispatch.key_generator&quot;</span>]
  <span class="ruby-identifier">http_auth_salt</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-string">&quot;action_dispatch.http_auth_salt&quot;</span>]
  <span class="ruby-identifier">key_generator</span>.<span class="ruby-identifier">generate_key</span>(<span class="ruby-identifier">http_auth_salt</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- secret_token-source -->
            
          </div>

          

          
        </div><!-- secret_token-method -->

      
        <div id="validate_digest_response-method" class="method-detail ">
          <a name="method-i-validate_digest_response"></a>

          
          <div class="method-heading">
            <span class="method-name">validate_digest_response</span><span
              class="method-args">(request, realm, &password_procedure)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns false unless the request credentials response value matches the
expected value. First try the password as a ha1 digest password. If this
fails, then try it as a plain text password.</p>
            

            
            <div class="method-source-code" id="validate_digest_response-source">
<pre>
<span class="ruby-comment"># File lib/action_controller/metal/http_authentication.rb, line 186</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">validate_digest_response</span>(<span class="ruby-identifier">request</span>, <span class="ruby-identifier">realm</span>, &amp;<span class="ruby-identifier">password_procedure</span>)
  <span class="ruby-identifier">secret_key</span>  = <span class="ruby-identifier">secret_token</span>(<span class="ruby-identifier">request</span>)
  <span class="ruby-identifier">credentials</span> = <span class="ruby-identifier">decode_credentials_header</span>(<span class="ruby-identifier">request</span>)
  <span class="ruby-identifier">valid_nonce</span> = <span class="ruby-identifier">validate_nonce</span>(<span class="ruby-identifier">secret_key</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">credentials</span>[<span class="ruby-value">:nonce</span>])

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">valid_nonce</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">realm</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">credentials</span>[<span class="ruby-value">:realm</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opaque</span>(<span class="ruby-identifier">secret_key</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">credentials</span>[<span class="ruby-value">:opaque</span>]
    <span class="ruby-identifier">password</span> = <span class="ruby-identifier">password_procedure</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">credentials</span>[<span class="ruby-value">:username</span>])
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">password</span>

    <span class="ruby-identifier">method</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-string">'rack.methodoverride.original_method'</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-string">'REQUEST_METHOD'</span>]
    <span class="ruby-identifier">uri</span>    = <span class="ruby-identifier">credentials</span>[<span class="ruby-value">:uri</span>]

    [<span class="ruby-keyword">true</span>, <span class="ruby-keyword">false</span>].<span class="ruby-identifier">any?</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">trailing_question_mark</span><span class="ruby-operator">|</span>
      [<span class="ruby-keyword">true</span>, <span class="ruby-keyword">false</span>].<span class="ruby-identifier">any?</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">password_is_ha1</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">_uri</span> = <span class="ruby-identifier">trailing_question_mark</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">uri</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;?&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">uri</span>
        <span class="ruby-identifier">expected</span> = <span class="ruby-identifier">expected_response</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">_uri</span>, <span class="ruby-identifier">credentials</span>, <span class="ruby-identifier">password</span>, <span class="ruby-identifier">password_is_ha1</span>)
        <span class="ruby-identifier">expected</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">credentials</span>[<span class="ruby-value">:response</span>]
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- validate_digest_response-source -->
            
          </div>

          

          
        </div><!-- validate_digest_response-method -->

      
        <div id="validate_nonce-method" class="method-detail ">
          <a name="method-i-validate_nonce"></a>

          
          <div class="method-heading">
            <span class="method-name">validate_nonce</span><span
              class="method-args">(secret_key, request, value, seconds_to_timeout=5*60)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Might want a shorter timeout depending on whether the request is a PATCH,
PUT, or POST, and if client is browser or web service. Can be much shorter
if the Stale directive is implemented. This would allow a user to use new
nonce without prompting user again for their username and password.</p>
            

            
            <div class="method-source-code" id="validate_nonce-source">
<pre>
<span class="ruby-comment"># File lib/action_controller/metal/http_authentication.rb, line 301</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">validate_nonce</span>(<span class="ruby-identifier">secret_key</span>, <span class="ruby-identifier">request</span>, <span class="ruby-identifier">value</span>, <span class="ruby-identifier">seconds_to_timeout</span>=<span class="ruby-value">5</span>*<span class="ruby-value">60</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-identifier">t</span> = <span class="ruby-operator">::</span><span class="ruby-constant">Base64</span>.<span class="ruby-identifier">decode64</span>(<span class="ruby-identifier">value</span>).<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot;:&quot;</span>).<span class="ruby-identifier">first</span>.<span class="ruby-identifier">to_i</span>
  <span class="ruby-identifier">nonce</span>(<span class="ruby-identifier">secret_key</span>, <span class="ruby-identifier">t</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">t</span> <span class="ruby-operator">-</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_i</span>).<span class="ruby-identifier">abs</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">seconds_to_timeout</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- validate_nonce-source -->
            
          </div>

          

          
        </div><!-- validate_nonce-method -->

      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

